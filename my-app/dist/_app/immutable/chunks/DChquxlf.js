import{t as G,a as W}from"./D1PqDKWF.js";import{i as X}from"./PUnCc7Gg.js";import{z as Z,y as z,A as I,B as N,a0 as H,a1 as M,m,F as E,C as _,D as $,a2 as ee}from"./Ks_cNANK.js";import{s as F}from"./BjRtELmc.js";import{_ as te,i as J}from"./BYkJfY_W.js";import{o as re,a as se}from"./DNvaIBBB.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */var k;(function(r){r.Unimplemented="UNIMPLEMENTED",r.Unavailable="UNAVAILABLE"})(k||(k={}));class q extends Error{constructor(e,t,o){super(e),this.message=e,this.code=t,this.data=o}}const ne=r=>{var e,t;return r!=null&&r.androidBridge?"android":!((t=(e=r==null?void 0:r.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},oe=r=>{const e=r.CapacitorCustomPlatform||null,t=r.Capacitor||{},o=t.Plugins=t.Plugins||{},s=()=>e!==null?e.name:ne(r),n=()=>s()!=="web",i=c=>{const l=h.get(c);return!!(l!=null&&l.platforms.has(s())||a(c))},a=c=>{var l;return(l=t.PluginHeaders)===null||l===void 0?void 0:l.find(L=>L.name===c)},d=c=>r.console.error(c),h=new Map,b=(c,l={})=>{const L=h.get(c);if(L)return console.warn(`Capacitor plugin "${c}" already registered. Cannot register plugins twice.`),L.proxy;const w=s(),p=a(c);let u;const O=async()=>(!u&&w in l?u=typeof l[w]=="function"?u=await l[w]():u=l[w]:e!==null&&!u&&"web"in l&&(u=typeof l.web=="function"?u=await l.web():u=l.web),u),j=(f,g)=>{var v,P;if(p){const C=p==null?void 0:p.methods.find(y=>g===y.name);if(C)return C.rtype==="promise"?y=>t.nativePromise(c,g.toString(),y):(y,R)=>t.nativeCallback(c,g.toString(),y,R);if(f)return(v=f[g])===null||v===void 0?void 0:v.bind(f)}else{if(f)return(P=f[g])===null||P===void 0?void 0:P.bind(f);throw new q(`"${c}" plugin is not implemented on ${w}`,k.Unimplemented)}},U=f=>{let g;const v=(...P)=>{const C=O().then(y=>{const R=j(y,f);if(R){const D=R(...P);return g=D==null?void 0:D.remove,D}else throw new q(`"${c}.${f}()" is not implemented on ${w}`,k.Unimplemented)});return f==="addListener"&&(C.remove=async()=>g()),C};return v.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(v,"name",{value:f,writable:!1,configurable:!1}),v},x=U("addListener"),A=U("removeListener"),S=(f,g)=>{const v=x({eventName:f},g),P=async()=>{const y=await v;A({eventName:f,callbackId:y},g)},C=new Promise(y=>v.then(()=>y({remove:P})));return C.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},C},T=new Proxy({},{get(f,g){switch(g){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return p?S:x;case"removeListener":return A;default:return U(g)}}});return o[c]=T,h.set(c,{name:c,proxy:T,platforms:new Set([...Object.keys(l),...p?[w]:[]])}),T};return t.convertFileSrc||(t.convertFileSrc=c=>c),t.getPlatform=s,t.handleError=d,t.isNativePlatform=n,t.isPluginAvailable=i,t.registerPlugin=b,t.Exception=q,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ae=r=>r.Capacitor=oe(r),B=ae(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),K=B.registerPlugin;class Q{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let o=!1;this.listeners[e]||(this.listeners[e]=[],o=!0),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),o&&this.sendRetainedArgumentsForEvent(e);const i=async()=>this.removeListener(e,t);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,o){const s=this.listeners[e];if(!s){if(o){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}return}s.forEach(n=>n(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:o=>{this.notifyListeners(t,o)}}}unimplemented(e="not implemented"){return new B.Exception(e,k.Unimplemented)}unavailable(e="not available"){return new B.Exception(e,k.Unavailable)}async removeListener(e,t){const o=this.listeners[e];if(!o)return;const s=o.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(o=>{this.notifyListeners(e,o)}))}}const V=r=>encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Y=r=>r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ie extends Q{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(o=>{if(o.length<=0)return;let[s,n]=o.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Y(s).trim(),n=Y(n).trim(),t[s]=n}),t}async setCookie(e){try{const t=V(e.key),o=V(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),i=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${o||""}${s}; path=${n}; ${i};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}K("CapacitorCookies",{web:()=>new ie});const ce=async r=>new Promise((e,t)=>{const o=new FileReader;o.onload=()=>{const s=o.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},o.onerror=s=>t(s),o.readAsDataURL(r)}),le=(r={})=>{const e=Object.keys(r);return Object.keys(r).map(s=>s.toLocaleLowerCase()).reduce((s,n,i)=>(s[n]=r[e[i]],s),{})},de=(r,e=!0)=>r?Object.entries(r).reduce((o,s)=>{const[n,i]=s;let a,d;return Array.isArray(i)?(d="",i.forEach(h=>{a=e?encodeURIComponent(h):h,d+=`${n}=${a}&`}),d.slice(0,-1)):(a=e?encodeURIComponent(i):i,d=`${n}=${a}`),`${o}&${d}`},"").substr(1):null,ue=(r,e={})=>{const t=Object.assign({method:r.method||"GET",headers:r.headers},e),s=le(r.headers)["content-type"]||"";if(typeof r.data=="string")t.body=r.data;else if(s.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[i,a]of Object.entries(r.data||{}))n.set(i,a);t.body=n.toString()}else if(s.includes("multipart/form-data")||r.data instanceof FormData){const n=new FormData;if(r.data instanceof FormData)r.data.forEach((a,d)=>{n.append(d,a)});else for(const a of Object.keys(r.data))n.append(a,r.data[a]);t.body=n;const i=new Headers(t.headers);i.delete("content-type"),t.headers=i}else(s.includes("application/json")||typeof r.data=="object")&&(t.body=JSON.stringify(r.data));return t};class fe extends Q{async request(e){const t=ue(e,e.webFetchExtra),o=de(e.params,e.shouldEncodeUrlParams),s=o?`${e.url}?${o}`:e.url,n=await fetch(s,t),i=n.headers.get("content-type")||"";let{responseType:a="text"}=n.ok?e:{};i.includes("application/json")&&(a="json");let d,h;switch(a){case"arraybuffer":case"blob":h=await n.blob(),d=await ce(h);break;case"json":d=await n.json();break;case"document":case"text":default:d=await n.text()}const b={};return n.headers.forEach((c,l)=>{b[l]=c}),{data:d,headers:b,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}K("CapacitorHttp",{web:()=>new fe});function pe(r){r.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(o,s){return(n,i,a)=>{const d=r.Capacitor.Plugins[t];if(d===void 0){a(new Error(`Capacitor plugin ${t} not found`));return}if(typeof d[s]!="function"){a(new Error(`Method ${s} not found in Capacitor plugin ${t}`));return}(async()=>{try{const h=await d[s](n);i(h)}catch(h){a(h)}})()}}})}})}function ge(r){r.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return r.cordova.plugins[t]}})}function he(r=!1){window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!r?pe(window):window.cordova!==void 0&&ge(window)}const we=K("Geolocation",{web:()=>te(()=>import("./BdAzWkdm.js"),[],import.meta.url).then(r=>new r.GeolocationWeb)});he();var me=G('<p><strong>Código HTTP:</strong> </p> <p><strong>Respuesta del servidor:</strong></p> <pre class="svelte-1dhl8jj"> </pre>',1),ve=G('<div class="error-box svelte-1dhl8jj"><h3>Error al actualizar ubicación</h3> <p><strong>Mensaje:</strong> </p> <!></div>'),ye=G("<!> <p> </p> <p> </p>",1);function _e(r,e){Z(e,!1);let t=M(""),o=M(""),s=M(null),n=null;const i=12;re(async()=>{async function w(){try{const p=await we.getCurrentPosition();if(H(t,p.coords.latitude.toFixed(6)),H(o,p.coords.longitude.toFixed(6)),isNaN(m(t))||isNaN(m(o)))throw{message:"Coordenadas inválidas",details:{lat:m(t),lon:m(o)}};const u=await fetch(`https://proyectomascotas.onrender.com/update_coordenadas_discapacitado/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({latitud:parseFloat(m(t)),longitud:parseFloat(m(o))})});if(!u.ok){const j=await u.json().catch(()=>({}));throw{status:u.status,statusText:u.statusText,serverError:j,url:u.url}}const O=await u.json();console.log("Respuesta exitosa:",O),H(s,null)}catch(p){H(s,{message:p.message||"Error desconocido",details:p}),console.error("Error completo:",JSON.stringify(p,null,2))}}w(),n=setInterval(w,15e3)}),se(()=>clearInterval(n)),X();var a=ye(),d=z(a);{var h=w=>{var p=ve(),u=E(_(p),2),O=E(_(u));$(u);var j=E(u,2);{var U=x=>{var A=me(),S=z(A),T=E(_(S));$(S);var f=E(S,4),g=_(f,!0);$(f),I(v=>{F(T,` ${m(s).details.status??""}`),F(g,v)},[()=>JSON.stringify(m(s).details.serverError,null,2)],ee),W(x,A)};J(j,x=>{m(s).details.status&&x(U)})}$(p),I(()=>F(O,` ${m(s).message??""}`)),W(w,p)};J(d,w=>{m(s)&&w(h)})}var b=E(d,2),c=_(b);$(b);var l=E(b,2),L=_(l);$(l),I(()=>{F(c,`Latitud: ${m(t)||"No disponible"}`),F(L,`Longitud: ${m(o)||"No disponible"}`)}),W(r,a),N()}export{Q as W,_e as _};
